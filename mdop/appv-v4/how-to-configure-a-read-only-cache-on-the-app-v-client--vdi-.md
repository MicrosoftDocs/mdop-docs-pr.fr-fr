---
title: Procédure pour configurer un cache en lecture seule dans App-V Client (VDI)
description: Procédure pour configurer un cache en lecture seule dans App-V Client (VDI)
author: dansimp
ms.assetid: 7a41e017-9e23-4a6a-a659-04d23f008b83
ms.reviewer: ''
manager: dansimp
ms.author: dansimp
ms.pagetype: mdop, appcompat, virtualization
ms.mktglfcycl: deploy
ms.sitesec: library
ms.prod: w10
ms.date: 08/30/2016
ms.openlocfilehash: 114f9dfbf55a3f62b6bc8bec6b37a659ffbfaf56
ms.sourcegitcommit: 354664bc527d93f80687cd2eba70d1eea024c7c3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/26/2020
ms.locfileid: "10807309"
---
# <span data-ttu-id="e3650-103">Procédure pour configurer un cache en lecture seule dans App-V Client (VDI)</span><span class="sxs-lookup"><span data-stu-id="e3650-103">How to Configure a Read-only Cache on the App-V Client (VDI)</span></span>


<span data-ttu-id="e3650-104">Dans Microsoft Application Virtualization (App-V) 4,6, le client prend en charge l’utilisation d’une mémoire cache en lecture seule partagée.</span><span class="sxs-lookup"><span data-stu-id="e3650-104">In Microsoft Application Virtualization (App-V) 4.6 the Client supports using a shared read-only cache.</span></span> <span data-ttu-id="e3650-105">Le cache en lecture seule partagé permet au client d’utiliser efficacement l’espace disque dans un système de bureau virtuel, dans lequel les utilisateurs exécutent des applications sur des machines virtuelles hébergées dans un environnement serveur du centre de données et partagent le stockage réseau sur un réseau de zone de stockage.</span><span class="sxs-lookup"><span data-stu-id="e3650-105">The shared read-only cache enables the Client to use disk space efficiently in a Virtual Desktop Infrastructure (VDI) system, where users run applications on Virtual Machines (VM) that are hosted in a data center server environment and share network storage on a Storage Area Network (SAN).</span></span> <span data-ttu-id="e3650-106">Les procédures suivantes fournissent une vue d’ensemble du processus requis pour implémenter le client App-V dans l’une des principales architectures VDI, connu sous le nom de «VM en pool» ou «VM statique».</span><span class="sxs-lookup"><span data-stu-id="e3650-106">The following procedures provide an overview of the process that is required to implement the App-V Client in either of the primary VDI architectures, known as “Pooled VM” or “Static VM”.</span></span> <span data-ttu-id="e3650-107">Il est supposé que vous êtes familiarisé avec la planification, le déploiement et l’exploitation du système App-V et de ses composants, ainsi que de l’opération et de la gestion du serveur VDI.</span><span class="sxs-lookup"><span data-stu-id="e3650-107">It is assumed that you are familiar with the planning, deployment, and operation of the App-V system and its components, and also the operation and management of the VDI server.</span></span> <span data-ttu-id="e3650-108">Pour plus d’informations sur App-V, voir [virtualisation des applications](https://go.microsoft.com/fwlink/?LinkId=122939) (https://go.microsoft.com/fwlink/?LinkId=122939)</span><span class="sxs-lookup"><span data-stu-id="e3650-108">For more information about App-V, see [Application Virtualization](https://go.microsoft.com/fwlink/?LinkId=122939) (https://go.microsoft.com/fwlink/?LinkId=122939)</span></span>

<span data-ttu-id="e3650-109">**Remarques**  Les détails décrits dans ces procédures sont uniquement destinés à des exemples.</span><span class="sxs-lookup"><span data-stu-id="e3650-109">**Note** The details outlined in these procedures are intended as examples only.</span></span> <span data-ttu-id="e3650-110">Vous pouvez utiliser différentes méthodes pour achever le processus global.</span><span class="sxs-lookup"><span data-stu-id="e3650-110">You might use different methods to complete the overall process.</span></span>

 

## <span data-ttu-id="e3650-111">Déploiement du client App-V dans un scénario VDI</span><span class="sxs-lookup"><span data-stu-id="e3650-111">Deploying the App-V Client in a VDI Scenario</span></span>


<span data-ttu-id="e3650-112">Vous pouvez déployer le client App-V dans un scénario VDI en utilisant un cache en lecture seule partagé qui a été rempli avec toutes les applications requises pour tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e3650-112">You can deploy the App-V Client in a VDI scenario by using a shared read-only cache that has been populated with all the applications required for all users.</span></span> <span data-ttu-id="e3650-113">Vous configurez ensuite l’image de l’ordinateur virtuel VDI maître de telle sorte que tous les clients App-V utilisent le même fichier de cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-113">You then configure the VDI Master VM Image so that all the App-V Clients use the same cache file.</span></span> <span data-ttu-id="e3650-114">Les utilisateurs peuvent accéder à des applications spécifiques à l’aide du processus de publication d’application-V.</span><span class="sxs-lookup"><span data-stu-id="e3650-114">Users are granted access to specific applications by using the App-V publishing process.</span></span> <span data-ttu-id="e3650-115">Dans la mesure où le cache est déjà préchargé avec toutes les applications, aucun flux n’est déclenché lorsqu’un utilisateur démarre une application.</span><span class="sxs-lookup"><span data-stu-id="e3650-115">Since the cache is already preloaded with all applications, no streaming occurs when a user starts an application.</span></span> <span data-ttu-id="e3650-116">Toutefois, les packages utilisés pour préremplir le cache doivent être placés sur un serveur App-V qui prend en charge la diffusion en continu du protocole RTSP (Real Time Streaming Protocol) et qui accorde des autorisations d’accès aux clients App-V.</span><span class="sxs-lookup"><span data-stu-id="e3650-116">However, the packages used to prepopulate the cache must be put on an App-V server that supports Real Time Streaming Protocol (RTSP) streaming and that grants access permissions to the App-V Clients.</span></span> <span data-ttu-id="e3650-117">Si vous publiez les applications à l’aide d’un serveur de gestion App-V, vous pouvez l’utiliser pour fournir cette fonction de diffusion en continu.</span><span class="sxs-lookup"><span data-stu-id="e3650-117">If you publish the applications by using an App-V Management Server, you can use it to provide this streaming function.</span></span>

<span data-ttu-id="e3650-118">Le processus de déploiement comporte quatre tâches principales:</span><span class="sxs-lookup"><span data-stu-id="e3650-118">The deployment process consists of four primary tasks:</span></span>

-   <span data-ttu-id="e3650-119">Création et remplissage du fichier cache principal partagé</span><span class="sxs-lookup"><span data-stu-id="e3650-119">Creating and populating the master shared cache file</span></span>

-   <span data-ttu-id="e3650-120">Copie du fichier cache partagé vers l’espace de stockage du serveur VDI</span><span class="sxs-lookup"><span data-stu-id="e3650-120">Copying the shared cache file to the VDI server storage</span></span>

-   <span data-ttu-id="e3650-121">Configuration du logiciel client App-V sur l’image maître d’infrastructure VDI</span><span class="sxs-lookup"><span data-stu-id="e3650-121">Configuring the App-V client software on the VDI Master Image</span></span>

-   <span data-ttu-id="e3650-122">Gestion du cycle de déploiement des mises à jour pour le fichier cache partagé après le déploiement initial</span><span class="sxs-lookup"><span data-stu-id="e3650-122">Managing the update deployment cycle for the shared cache file after the initial deployment</span></span>

<span data-ttu-id="e3650-123">Les tâches suivantes nécessitent une planification soigneuse.</span><span class="sxs-lookup"><span data-stu-id="e3650-123">These tasks require careful planning.</span></span> <span data-ttu-id="e3650-124">Nous vous recommandons de préparer et de documenter un processus méthodique et reproductible à respecter par votre organisation.</span><span class="sxs-lookup"><span data-stu-id="e3650-124">We recommend that you prepare and document a methodical, reproducible process for your organization to follow.</span></span> <span data-ttu-id="e3650-125">Ceci est particulièrement important pour la préparation initiale et le déploiement du fichier cache principal partagé et pour la gestion des mises à jour de l’application, qui requièrent chacune une mise à jour du cache partagé maître.</span><span class="sxs-lookup"><span data-stu-id="e3650-125">This is especially important for the initial preparation and deployment of the master shared cache file, and for the on-going management of application updates, each of which require an update to the master shared cache.</span></span> <span data-ttu-id="e3650-126">Utilisez les procédures suivantes pour effectuer ces tâches principales.</span><span class="sxs-lookup"><span data-stu-id="e3650-126">Use the following procedures to complete these primary tasks.</span></span>

<span data-ttu-id="e3650-127">**Remarques**  Même si vous pouvez publier les applications à l’aide de plusieurs méthodes différentes, les procédures suivantes sont basées sur l’utilisation d’un serveur de gestion d’applications-V pour la publication.</span><span class="sxs-lookup"><span data-stu-id="e3650-127">**Note** Although you can publish the applications by using several different methods, the following procedures are based on the use of an App-V Management Server for publishing.</span></span>

 

**<span data-ttu-id="e3650-128">Pour configurer le cache en lecture seule pour le déploiement initial dans un scénario d’infrastructure VDI en pool ou d’infrastructure virtuelle VM</span><span class="sxs-lookup"><span data-stu-id="e3650-128">To configure the read-only cache for initial deployment in a Pooled VM VDI or Static VM VDI scenario</span></span>**

1. <span data-ttu-id="e3650-129">Configurez et configurez un serveur d’administration d’applications-V dans un VM sur le serveur VDI pour fournir une authentification et une prise en charge de la publication.</span><span class="sxs-lookup"><span data-stu-id="e3650-129">Set up and configure an App-V Management Server in a VM on the VDI server to provide user authentication and publishing support.</span></span>

2. <span data-ttu-id="e3650-130">Remplissez le dossier de contenu de ce serveur de gestion avec tous les packages d’application requis pour tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e3650-130">Populate the Content folder of this Management Server with all the application packages required for all users.</span></span>

3. <span data-ttu-id="e3650-131">Configurer un ordinateur intermédiaire sur lequel le client App-V est installé.</span><span class="sxs-lookup"><span data-stu-id="e3650-131">Set up a staging computer that has the App-V Client installed.</span></span> <span data-ttu-id="e3650-132">Connectez-vous à l’ordinateur intermédiaire à l’aide d’un compte qui a accès à toutes les applications de sorte que l’ensemble complet d’applications soit publié sur l’ordinateur, puis diffusez le cache des applications afin qu’elles soient entièrement chargées.</span><span class="sxs-lookup"><span data-stu-id="e3650-132">Log on to the staging computer with an account that has access to all applications so that the complete set of applications are published to the computer, and then stream the applications to cache so that they are fully loaded.</span></span>

   **<span data-ttu-id="e3650-133">Important</span><span class="sxs-lookup"><span data-stu-id="e3650-133">Important</span></span>**  
   <span data-ttu-id="e3650-134">L’ordinateur intermédiaire doit utiliser le même type de système d’exploitation et l’même architecture système que ceux utilisés par les VM sur lesquelles le client App-V sera exécuté.</span><span class="sxs-lookup"><span data-stu-id="e3650-134">The staging computer must use the same operating system type and system architecture as those used by the VMs on which the App-V Client will run.</span></span>

     

4. <span data-ttu-id="e3650-135">Redémarrez l’ordinateur intermédiaire en mode sans échec pour vous assurer que les pilotes ne sont pas démarrés, ce qui verrouille le fichier de cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-135">Restart the staging computer in Safe Mode to ensure the drivers are not started, which would lock the cache file.</span></span>

   **<span data-ttu-id="e3650-136">Remarque</span><span class="sxs-lookup"><span data-stu-id="e3650-136">Note</span></span>**  
   <span data-ttu-id="e3650-137">Vous pouvez également arrêter et désactiver le service de virtualisation des applications, puis redémarrer l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e3650-137">Alternatively, you can stop and disable the Application Virtualization service, and then restart the computer.</span></span> <span data-ttu-id="e3650-138">Après avoir copié le fichier, n’oubliez pas d’activer et de redémarrer le service.</span><span class="sxs-lookup"><span data-stu-id="e3650-138">After the file has been copied, remember to enable and start the service again.</span></span>

     

5. <span data-ttu-id="e3650-139">Copiez le fichier cache Sftfs. FSD sur le réseau de stockage du serveur VDI sur lequel tous les ordinateurs virtuels peuvent y accéder, par exemple dans un dossier partagé.</span><span class="sxs-lookup"><span data-stu-id="e3650-139">Copy the Sftfs.fsd cache file to the VDI server’s SAN where all the VMs can access it, such as in a shared folder.</span></span> <span data-ttu-id="e3650-140">Définissez les autorisations d’accès aux dossiers sur lecture seule pour le groupe tout le monde et sur contrôle total pour les administrateurs qui gèrent les mises à jour de fichier cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-140">Set the folder access permissions to Read-only for the group Everyone and to Full Control for administrators who will manage the cache file updates.</span></span> <span data-ttu-id="e3650-141">L’emplacement du fichier cache peut être obtenu à partir de l’AppFS\\FileName. de Registre</span><span class="sxs-lookup"><span data-stu-id="e3650-141">The location of the cache file can be obtained from the registry AppFS\\FileName.</span></span>

   **<span data-ttu-id="e3650-142">Important</span><span class="sxs-lookup"><span data-stu-id="e3650-142">Important</span></span>**  
   <span data-ttu-id="e3650-143">Le fichier FSD doit se trouve dans un emplacement doté de la réactivité et de la fiabilité correspondant aux performances de stockage connectées localement, par exemple un réseau SAN.</span><span class="sxs-lookup"><span data-stu-id="e3650-143">You must put the FSD file in a location that has the responsiveness and reliability equivalent to locally attached storage performance, for example, a SAN.</span></span>

     

6. <span data-ttu-id="e3650-144">Installez le client de bureau App-V sur l’image de l’ordinateur virtuel VDI maître, puis configurez-le pour qu’il utilise le cache en lecture seule en ajoutant les valeurs de clé de Registre suivantes à la clé AppFS sur le client.</span><span class="sxs-lookup"><span data-stu-id="e3650-144">Install the App-V Desktop Client on the VDI Master VM Image, and then configure it to use the read-only cache by adding the following registry key values to the AppFS key on the client.</span></span> <span data-ttu-id="e3650-145">La clé AppFS est située dans HKEY \ _LOCAL \ _MACHINE \\SOFTWARE\\\ [Wow6432Node\\\] Microsoft\\SoftGrid\\4.5\\Client\\AppFS.</span><span class="sxs-lookup"><span data-stu-id="e3650-145">The AppFS key is located at HKEY\_LOCAL\_MACHINE\\SOFTWARE\\\[Wow6432Node\\\]Microsoft\\SoftGrid\\4.5\\Client\\AppFS.</span></span>

   <table>
   <colgroup>
   <col width="25%" />
   <col width="25%" />
   <col width="25%" />
   <col width="25%" />
   </colgroup>
   <thead>
   <tr class="header">
   <th align="left"><span data-ttu-id="e3650-146">Clé</span><span class="sxs-lookup"><span data-stu-id="e3650-146">Key</span></span></th>
   <th align="left"><span data-ttu-id="e3650-147">Type</span><span class="sxs-lookup"><span data-stu-id="e3650-147">Type</span></span></th>
   <th align="left"><span data-ttu-id="e3650-148">Valeur</span><span class="sxs-lookup"><span data-stu-id="e3650-148">Value</span></span></th>
   <th align="left"><span data-ttu-id="e3650-149">Objectif</span><span class="sxs-lookup"><span data-stu-id="e3650-149">Purpose</span></span></th>
   </tr>
   </thead>
   <tbody>
   <tr class="odd">
   <td align="left"><p><span data-ttu-id="e3650-150">FileName</span><span class="sxs-lookup"><span data-stu-id="e3650-150">FileName</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-151">String</span><span class="sxs-lookup"><span data-stu-id="e3650-151">String</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-152">Path to FSD</span><span class="sxs-lookup"><span data-stu-id="e3650-152">path to FSD</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-153">Spécifie le chemin d’accès au fichier cache partagé, par exemple \VDIServername\Sharefolder\SFTFS. FSD (obligatoire).</span><span class="sxs-lookup"><span data-stu-id="e3650-153">Specifies the path to the shared cache file, for example, \VDIServername\Sharefolder\SFTFS.FSD (Required).</span></span></p></td>
   </tr>
   <tr class="even">
   <td align="left"><p><span data-ttu-id="e3650-154">ReadOnlyFSD</span><span class="sxs-lookup"><span data-stu-id="e3650-154">ReadOnlyFSD</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-155">DWORD</span><span class="sxs-lookup"><span data-stu-id="e3650-155">DWORD</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-156">1</span><span class="sxs-lookup"><span data-stu-id="e3650-156">1</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-157">Configure le client pour qu’il fonctionne en mode lecture seule.</span><span class="sxs-lookup"><span data-stu-id="e3650-157">Configures the client to operate in Read-Only mode.</span></span> <span data-ttu-id="e3650-158">Cela permet de s’assurer que le client ne tente pas de diffuser en continu des mises à jour du cache du package.</span><span class="sxs-lookup"><span data-stu-id="e3650-158">This ensures that the client will not attempt to stream updates to the package cache.</span></span> <span data-ttu-id="e3650-159">(obligatoire)</span><span class="sxs-lookup"><span data-stu-id="e3650-159">(Required)</span></span></p></td>
   </tr>
   <tr class="odd">
   <td align="left"><p><span data-ttu-id="e3650-160">ErrorLogLocation</span><span class="sxs-lookup"><span data-stu-id="e3650-160">ErrorLogLocation</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-161">String</span><span class="sxs-lookup"><span data-stu-id="e3650-161">String</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-162">chemin d’accès au fichier journal des erreurs (. ETL)</span><span class="sxs-lookup"><span data-stu-id="e3650-162">path to error log (.etl) file</span></span></p></td>
   <td align="left"><p><span data-ttu-id="e3650-163">Entrée utilisée pour spécifier le chemin d’accès au journal des erreurs.</span><span class="sxs-lookup"><span data-stu-id="e3650-163">Entry used to specify the path to the error log.</span></span> <span data-ttu-id="e3650-164">Recommande.</span><span class="sxs-lookup"><span data-stu-id="e3650-164">(Recommended.</span></span> <span data-ttu-id="e3650-165">Utiliser un chemin d’accès local tel que C:\Logs\Sftfs.etl).</span><span class="sxs-lookup"><span data-stu-id="e3650-165">Use a local path such as C:\Logs\Sftfs.etl).</span></span></p></td>
   </tr>
   </tbody>
   </table>

     

7. <span data-ttu-id="e3650-166">Configurez le client d’image VM maître de façon à utiliser le serveur de publication et à utiliser l’actualisation de publication lors de la connexion.</span><span class="sxs-lookup"><span data-stu-id="e3650-166">Configure the Master VM Image client to use the publishing server and to use publishing refresh at logon.</span></span> <span data-ttu-id="e3650-167">Lorsque les utilisateurs ouvrent une session sur le système VDI et qu’ils sont créés à partir de l’image VM maître, un cycle d’actualisation de publication se produit et publie toutes les applications pour lesquelles leur compte est autorisé.</span><span class="sxs-lookup"><span data-stu-id="e3650-167">As users log on to the VDI system and their VM is built from the Master VM Image, a publishing refresh cycle occurs and publishes all the applications for which their account is authorized.</span></span> <span data-ttu-id="e3650-168">Ces applications sont exécutées à partir du cache partagé.</span><span class="sxs-lookup"><span data-stu-id="e3650-168">These applications are run from the shared cache.</span></span>

**<span data-ttu-id="e3650-169">Pour configurer le client pour la mise à niveau du package dans un scénario VM en pool</span><span class="sxs-lookup"><span data-stu-id="e3650-169">To configure the client for package upgrade in a Pooled VM scenario</span></span>**

1.  <span data-ttu-id="e3650-170">Effectuez la mise à niveau et le test du package d’application.</span><span class="sxs-lookup"><span data-stu-id="e3650-170">Complete the upgrade and testing of the application package.</span></span>

2.  <span data-ttu-id="e3650-171">Mettez à niveau le package sur le serveur App-V.</span><span class="sxs-lookup"><span data-stu-id="e3650-171">Upgrade the package on the App-V server.</span></span> <span data-ttu-id="e3650-172">Ensuite, publiez et diffusez la nouvelle version des applications sur le client de l’ordinateur intermédiaire de sorte qu’elles soient entièrement chargées dans le cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-172">Then, publish and stream the new version of the applications to the client on the staging computer so that they are fully loaded into cache.</span></span>

3.  <span data-ttu-id="e3650-173">Redémarrez l’ordinateur intermédiaire en mode sans échec pour vous assurer que les pilotes ne sont pas démarrés.</span><span class="sxs-lookup"><span data-stu-id="e3650-173">Restart the staging computer in Safe Mode to ensure the drivers are not started.</span></span>

    <span data-ttu-id="e3650-174">**Remarques**  Vous pouvez également arrêter et désactiver le service de virtualisation des applications dans services. msc, puis redémarrez l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e3650-174">**Note** Alternatively, you can stop and disable the Application Virtualization service in the Services.msc, and then restart the computer.</span></span> <span data-ttu-id="e3650-175">Après avoir copié le fichier, n’oubliez pas d’activer et de redémarrer le service.</span><span class="sxs-lookup"><span data-stu-id="e3650-175">After the file has been copied, remember to enable and start the service again.</span></span>

     

4.  <span data-ttu-id="e3650-176">Copiez le fichier cache Sftfs. FSD sur le réseau de stockage du serveur VDI sur lequel tous les ordinateurs virtuels peuvent y accéder, par exemple dans un dossier partagé.</span><span class="sxs-lookup"><span data-stu-id="e3650-176">Copy the Sftfs.fsd cache file to the VDI server’s SAN where all the VMs can access it, such as in a shared folder.</span></span> <span data-ttu-id="e3650-177">Vous pouvez utiliser un autre nom de fichier, par exemple, SFTFS \ _V2. FSD, pour distinguer la nouvelle version.</span><span class="sxs-lookup"><span data-stu-id="e3650-177">You can use a different filename, for example, SFTFS\_V2.FSD, to distinguish the new version.</span></span>

5.  <span data-ttu-id="e3650-178">Pour configurer le client de bureau App-V sur l’image de l’ordinateur virtuel VDI maître pour utiliser le fichier cache partagé mis à jour, modifiez la valeur nom de fichier de clé de Registre AppFS pour qu’elle pointe vers l’emplacement du fichier mis à jour, par exemple, \\\\VDIServername\\Sharefolder\\SFTFS\ _V2. FSD.</span><span class="sxs-lookup"><span data-stu-id="e3650-178">To configure the App-V Desktop Client on the VDI Master VM Image to use the updated shared cache file, change the AppFS registry key FILENAME value to point to the location of the updated file, for example, \\\\VDIServername\\Sharefolder\\SFTFS\_V2.FSD.</span></span> <span data-ttu-id="e3650-179">Lorsqu’un utilisateur se déconnecte et se reconnecte, un nouvel ordinateur virtuel est créé pour eux à l’aide de l’image maître mise à jour.</span><span class="sxs-lookup"><span data-stu-id="e3650-179">When users log off and then log on again, a new VM is created for them by using the updated Master Image.</span></span> <span data-ttu-id="e3650-180">Tous leurs paramètres utilisateur seront conservés et appliqués au nouvel ordinateur virtuel.</span><span class="sxs-lookup"><span data-stu-id="e3650-180">All their user settings will be retained and applied to the new VM.</span></span> <span data-ttu-id="e3650-181">Ils ont alors accès aux applications mises à jour.</span><span class="sxs-lookup"><span data-stu-id="e3650-181">Then they have access to the updated applications.</span></span>

**<span data-ttu-id="e3650-182">Pour configurer le client pour la mise à niveau du package dans un scénario d’ordinateur virtuel statique</span><span class="sxs-lookup"><span data-stu-id="e3650-182">To configure the client for package upgrade in a Static VM scenario</span></span>**

1.  <span data-ttu-id="e3650-183">Effectuez la mise à niveau et le test du package d’application.</span><span class="sxs-lookup"><span data-stu-id="e3650-183">Complete the upgrade and testing of the application package.</span></span>

2.  <span data-ttu-id="e3650-184">Mettez à niveau le package sur le serveur App-V.</span><span class="sxs-lookup"><span data-stu-id="e3650-184">Upgrade the package on the App-V server.</span></span> <span data-ttu-id="e3650-185">Ensuite, publiez et diffusez la nouvelle version des applications sur le client de l’ordinateur intermédiaire de sorte que les applications soient entièrement chargées dans le cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-185">Then, publish and stream the new version of the applications to the client on the staging computer so that the applications are fully loaded into cache.</span></span>

3.  <span data-ttu-id="e3650-186">Redémarrez l’ordinateur intermédiaire en mode sans échec pour vous assurer que les pilotes ne sont pas démarrés.</span><span class="sxs-lookup"><span data-stu-id="e3650-186">Restart the staging computer in Safe Mode to ensure that the drivers are not started.</span></span>

    <span data-ttu-id="e3650-187">**Remarques**  Vous pouvez également arrêter et désactiver le service de virtualisation des applications dans services. msc, puis redémarrez l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e3650-187">**Note** Alternatively, you can stop and disable the Application Virtualization service in the Services.msc, and then restart the computer.</span></span> <span data-ttu-id="e3650-188">Après avoir copié le fichier, n’oubliez pas d’activer et de redémarrer le service.</span><span class="sxs-lookup"><span data-stu-id="e3650-188">After the file has been copied, remember to enable and start the service again.</span></span>

     

4.  <span data-ttu-id="e3650-189">Copiez le fichier cache Sftfs. FSD sur le réseau de stockage du serveur VDI sur lequel tous les ordinateurs virtuels peuvent y accéder, par exemple dans un dossier partagé.</span><span class="sxs-lookup"><span data-stu-id="e3650-189">Copy the Sftfs.fsd cache file to the VDI server’s SAN where all the VMs can access it, such as in a shared folder.</span></span> <span data-ttu-id="e3650-190">Vous pouvez utiliser un autre nom de fichier, par exemple, SFTFS \ _V2. FSD, pour distinguer la nouvelle version.</span><span class="sxs-lookup"><span data-stu-id="e3650-190">You can use a different filename, for example, SFTFS\_V2.FSD, to distinguish the new version.</span></span>

5.  <span data-ttu-id="e3650-191">Pour configurer le client de bureau App-V sur l’image de l’ordinateur virtuel VDI maître pour utiliser le fichier cache partagé mis à jour, modifiez la valeur nom de fichier de clé de Registre AppFS pour qu’elle pointe vers l’emplacement du fichier mis à jour, par exemple, \\\\VDIServername\\Sharefolder\\SFTFS\ _V2. FSD.</span><span class="sxs-lookup"><span data-stu-id="e3650-191">To configure the App-V Desktop Client on the VDI Master VM Image to use the updated shared cache file, change the AppFS registry key FILENAME value to point to the location of the updated file, for example, \\\\VDIServername\\Sharefolder\\SFTFS\_V2.FSD.</span></span> <span data-ttu-id="e3650-192">Cela permet à tous les nouveaux utilisateurs d’obtenir la nouvelle version.</span><span class="sxs-lookup"><span data-stu-id="e3650-192">This ensures that new users get the new version.</span></span>

6.  <span data-ttu-id="e3650-193">Créez un script qui modifie la valeur nom de fichier de la clé AppFS pour la définir sur l’emplacement du cache mis à jour, par exemple, \\\\VDIServername\\Sharefolder\\SFTFS\ _V2. FSD.</span><span class="sxs-lookup"><span data-stu-id="e3650-193">Create a script that edits the AppFS key FILENAME value to set it to the location of the updated cache, for example, \\\\VDIServername\\Sharefolder\\SFTFS\_V2.FSD.</span></span> <span data-ttu-id="e3650-194">Configurez ce script pour qu’il s’exécute lorsque l’utilisateur se déconnecte ou qu’il se connecte pour qu’il s’exécute avant le début des pilotes clients App-V, par exemple, à l’aide des paramètres de stratégie de groupe.</span><span class="sxs-lookup"><span data-stu-id="e3650-194">Configure this script to run when the user logs off or logs on so that it runs before the App-V client drivers start, for example, by using Group Policy settings.</span></span> <span data-ttu-id="e3650-195">Lorsqu’un utilisateur se déconnecte et se reconnecte, son ordinateur virtuel existant est mis à jour et utilise la copie mise à jour du cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-195">When users log off and log on again, their existing VM is updated, and they will use the updated copy of the cache.</span></span> <span data-ttu-id="e3650-196">Ils ont ensuite accès aux applications mises à jour.</span><span class="sxs-lookup"><span data-stu-id="e3650-196">Then, they have access to the updated applications.</span></span>

## <span data-ttu-id="e3650-197">Utiliser des liens symboliques lors de la mise à niveau du cache</span><span class="sxs-lookup"><span data-stu-id="e3650-197">How to Use Symbolic Links when Upgrading the Cache</span></span>


<span data-ttu-id="e3650-198">Au lieu de modifier la valeur nom de fichier de la clé AppFS chaque fois qu’un nouveau fichier cache contient des packages nouveaux ou mis à niveau, vous pouvez utiliser un lien symbolique dans les systèmes d’exploitation suivants: Windows Vista, Windows 7 et Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="e3650-198">Instead of modifying the AppFS key FILENAME value every time that a new cache file is deployed that contains new or upgraded packages, you can use a symbolic link in the following operating systems: Windows Vista, Windows 7, and Windows Server 2008.</span></span> <span data-ttu-id="e3650-199">Pour plus d’informations sur les liens symboliques, voir [liens symboliques](https://go.microsoft.com/fwlink/?LinkId=157626) ( https://go.microsoft.com/fwlink/?LinkId=157626) .</span><span class="sxs-lookup"><span data-stu-id="e3650-199">For more information about symbolic links, see [Symbolic Links](https://go.microsoft.com/fwlink/?LinkId=157626) (https://go.microsoft.com/fwlink/?LinkId=157626).</span></span> <span data-ttu-id="e3650-200">En revanche, Windows XP ne prend pas en charge l’utilisation de liens symboliques et vous devez plutôt utiliser des points de jonction.</span><span class="sxs-lookup"><span data-stu-id="e3650-200">In contrast, Windows XP does not support the use of symbolic links, and you must use junction points instead.</span></span> <span data-ttu-id="e3650-201">Pour plus d’informations sur les jointures, reportez-vous à [l’article 205524](https://go.microsoft.com/fwlink/?LinkId=182553) de la base de connaissances Microsoft ( https://go.microsoft.com/fwlink/?LinkId=182553) et également à la jointure d’outil [v 1.05](https://go.microsoft.com/fwlink/?LinkId=182554) () https://go.microsoft.com/fwlink/?LinkId=182554) .</span><span class="sxs-lookup"><span data-stu-id="e3650-201">For more information about junctions, see [article 205524](https://go.microsoft.com/fwlink/?LinkId=182553) in the Microsoft Knowledge Base (https://go.microsoft.com/fwlink/?LinkId=182553), and also the tool [Junction v1.05](https://go.microsoft.com/fwlink/?LinkId=182554) (https://go.microsoft.com/fwlink/?LinkId=182554).</span></span>

**<span data-ttu-id="e3650-202">Pour configurer un lien symbolique pour référencer le cache</span><span class="sxs-lookup"><span data-stu-id="e3650-202">To configure a symbolic link to reference the cache</span></span>**

1.  <span data-ttu-id="e3650-203">Pendant la phase de déploiement initiale, ouvrez une fenêtre d’invite de commandes en tant qu’administrateur local sur le système d’exploitation hôte du serveur VDI.</span><span class="sxs-lookup"><span data-stu-id="e3650-203">During the initial deployment stage, open a Command Prompt window as a local administrator on the VDI server host operating system.</span></span>

2.  <span data-ttu-id="e3650-204">Créez un lien symbolique à l’aide de la commande MKLINK, puis configurez-le pour qu’il pointe sur le fichier Sftfs. FSD.</span><span class="sxs-lookup"><span data-stu-id="e3650-204">Create a symbolic link by using the MKLINK command, and then configure it to point to the Sftfs.fsd file.</span></span>

    **     <span data-ttu-id="e3650-205">mklink symlinkname \\\\vdihostserver\\sharefolder\\sftfs.fsd</span><span class="sxs-lookup"><span data-stu-id="e3650-205">mklink symlinkname \\\\vdihostserver\\sharefolder\\sftfs.fsd</span></span>**

3.  <span data-ttu-id="e3650-206">Sur l’image de l’ordinateur virtuel VDI maître, ouvrez une fenêtre d’invite de commandes à l’aide de l’option **exécuter en tant qu’administrateur** , puis accordez des autorisations de lien distant pour permettre à l’ordinateur virtuel d’accéder au lien symbolique du système d’exploitation de l’hôte VDI.</span><span class="sxs-lookup"><span data-stu-id="e3650-206">On the VDI Master VM Image, open a Command Prompt window by using the **Run as administrator** option and grant remote link permissions so that the VM can access the symbolic link on the VDI Host operating system.</span></span> <span data-ttu-id="e3650-207">Par défaut, les autorisations de liaison distantes ne sont pas activées.</span><span class="sxs-lookup"><span data-stu-id="e3650-207">By default, remote link permissions are disabled.</span></span>

    **<span data-ttu-id="e3650-208">fsutil behavior Set SymlinkEvaluation R2R: 1</span><span class="sxs-lookup"><span data-stu-id="e3650-208">fsutil behavior set SymlinkEvaluation R2R:1</span></span>**

    <span data-ttu-id="e3650-209">**Remarques**  Sur le serveur de stockage, les autorisations de liaison appropriées doivent être activées.</span><span class="sxs-lookup"><span data-stu-id="e3650-209">**Note** On the storage server, appropriate link permissions must be enabled.</span></span> <span data-ttu-id="e3650-210">En fonction de l’emplacement du lien et du fichier Sftfs. FSD, les autorisations sont **L2L: 1** ou **L2R: 1** ou **R2L: 1** ou **R2R: 1**.</span><span class="sxs-lookup"><span data-stu-id="e3650-210">Depending on the location of link and the Sftfs.fsd file, the permissions are **L2L:1** or **L2R:1** or **R2L:1** or **R2R:1**.</span></span>

     

4.  <span data-ttu-id="e3650-211">Lorsque vous configurez le client de bureau App-V sur l’image de l’ordinateur virtuel VDI maître, définissez la valeur nom de fichier de clé AppFS sur le chemin d’accès UNC du fichier FSD qui utilise le lien symbolique. par exemple, attribuez-lui la valeur \\\\VDIHostserver\\Symlinkname.</span><span class="sxs-lookup"><span data-stu-id="e3650-211">When you configure the App-V Desktop Client on the VDI Master VM Image, set the AppFS key FILENAME value equal to the UNC path of the FSD file that is using the symbolic link; for example, set it to \\\\VDIHostserver\\Symlinkname.</span></span> <span data-ttu-id="e3650-212">Lorsque le client App-V accède au cache pour la première fois, le lien symbolique passe au client un handle vers le fichier du cache.</span><span class="sxs-lookup"><span data-stu-id="e3650-212">When the App-V client first accesses the cache, the symbolic link passes to the client a handle to the cache file.</span></span> <span data-ttu-id="e3650-213">Le client continue d’utiliser ce handle tant que le client est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e3650-213">The client continues to use that handle as long as the client is running.</span></span> <span data-ttu-id="e3650-214">La valeur du lien symbolique peut être mise à jour en toute sécurité même si l’ancien cache partagé est ouvert.</span><span class="sxs-lookup"><span data-stu-id="e3650-214">The value of the symbolic link can safely be updated even if existing clients have the old shared cache open.</span></span>

5.  <span data-ttu-id="e3650-215">Lorsque vous devez effectuer la mise à niveau d’un package ou ajouter un nouveau package au cache, suivez les étapes 1 à 5 de la procédure de mise à niveau pour le scénario d’ordinateur virtuel statique ou de pool.</span><span class="sxs-lookup"><span data-stu-id="e3650-215">When you must upgrade a package or to add a new package to the cache, follow steps 1 through 5 of the upgrade procedure for either the Static VM or Pooled VM scenario.</span></span> <span data-ttu-id="e3650-216">Ensuite, supprimez le lien symbolique et recréez-le pour qu’il pointe vers la nouvelle version du fichier cache partagé.</span><span class="sxs-lookup"><span data-stu-id="e3650-216">Then, delete the symbolic link and re-create it to point to the new version of the shared cache file.</span></span> <span data-ttu-id="e3650-217">Au redémarrage de l’ordinateur virtuel, le client reçoit un handle vers la copie mise à jour du cache, car l’ordinateur virtuel utilise le chemin d’accès contenant le lien symbolique mis à jour.</span><span class="sxs-lookup"><span data-stu-id="e3650-217">When the VM is restarted, the client receives a handle to the updated copy of the cache because the VM uses the path that contains the updated symbolic link.</span></span> <span data-ttu-id="e3650-218">Les utilisateurs ont ensuite accès aux applications nouvelles et mises à jour.</span><span class="sxs-lookup"><span data-stu-id="e3650-218">Then, the users have access to the new and updated applications.</span></span>

## <span data-ttu-id="e3650-219">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e3650-219">Related topics</span></span>


[<span data-ttu-id="e3650-220">Procédure pour installer le serveur Application Virtualization Management Server</span><span class="sxs-lookup"><span data-stu-id="e3650-220">How to Install Application Virtualization Management Server</span></span>](how-to-install-application-virtualization-management-server.md)

[<span data-ttu-id="e3650-221">Procédure pour installer manuellement Application Virtualization Client</span><span class="sxs-lookup"><span data-stu-id="e3650-221">How to Manually Install the Application Virtualization Client</span></span>](how-to-manually-install-the-application-virtualization-client.md)

[<span data-ttu-id="e3650-222">Procédure pour installer le client via la ligne de commande</span><span class="sxs-lookup"><span data-stu-id="e3650-222">How to Install the Client by Using the Command Line</span></span>](how-to-install-the-client-by-using-the-command-line-new.md)

 

 





